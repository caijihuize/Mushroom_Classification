# 蘑菇分类系统

基于深度学习的食用菌图像识别与分类系统

## 项目介绍

本项目利用深度学习技术构建了一个能够识别和分类常见食用菌（蘑菇）种类的系统。系统基于卷积神经网络框架，使用迁移学习方法，可准确识别36种常见食用菌。项目包含了丰富的蘑菇描述信息和示例图片，可用于训练模型和教育展示。

## 数据集

项目包含36种常见食用菌的图像数据和描述信息：
- 珍贵食用菌：羊肚菌、牛肝菌、松茸、松露、竹荪、虫草花等
- 木耳类：黑木耳、银耳、金耳等
- 菇类：香菇、平菇、金针菇、杏鲍菇、鸡腿菇、猴头菇等
- 野生菌：鸡油菌、鸡枞菌、青头菌、奶浆菌、干巴菌、虎掌菌等

每个类别约有200张图像，总计约7000+张图像。同时，`mushrooms.json`文件中包含了每种蘑菇的详细描述信息，包括学名、特征、生长环境等。`images`目录中则存储了每种蘑菇的5张示例图片，可用于快速了解各类蘑菇的外观特征。

数据来源：通过网络爬虫从百度图片搜索API获取

## 项目结构

```
Mushroom_Classification/
│
├── data/                      # 图像数据集目录（按分类整理）
│   ├── class0/               # 羊肚菌图像
│   ├── class1/               # 牛肝菌图像
│   └── ...                   # 其他分类
│
├── images/                    # 蘑菇类型示例图像
│   ├── 羊肚菌/                # 羊肚菌示例图像
│   ├── 牛肝菌/                # 牛肝菌示例图像
│   └── ...                   # 其他蘑菇类型
│
├── step1_data.py              # 数据收集与处理脚本
├── step2_dataClean.ipynb      # 数据预处理和模型训练脚本
├── label.txt                  # 分类标签映射文件
├── mushrooms.json             # 蘑菇描述信息JSON文件
├── SimHei.ttf                 # 中文字体文件（用于可视化）
├── requirements.txt           # 项目依赖文件
└── README.md                  # 项目说明文档
```

## 蘑菇数据

`mushrooms.json`文件中包含了36种常见食用菌的详细信息，包括：
- **Name**: 蘑菇中文名称
- **Description**: 详细描述，包括学名、形态特征、生长环境和分布区域
- **Feature**: 主要外观特征和识别要点
- **ImageUrls**: 示例图片路径，存储于`images`目录中

这些详细信息可以帮助研究人员和爱好者更全面地了解各种蘑菇的特点，同时也为深度学习模型提供了丰富的标签信息。

## 技术实现

### 1. 数据收集和处理
- 使用Selenium和BeautifulSoup从百度图片搜索下载图像
- 抓取百度百科对应蘑菇种类的描述信息
- 对图像进行标准化处理和存储

### 2. 模型训练
- 基础框架：TensorFlow
- 数据增强：随机翻转、旋转、缩放等操作
- 模型架构：采用迁移学习，对比了多种预训练模型的性能
  - MobileNet
  - MobileNetV2
  - MobileNetV3Small
  - EfficientNetB0
  - EfficientNetV2S
  - ResNet101

### 3. 评估指标
- 准确率（Accuracy）
- 精确率（Precision）
- 召回率（Recall）
- F1分数

## 使用说明

### 环境配置
```bash
pip install -r requirements.txt
```

### 数据集准备
如果要从头开始收集数据，运行：
```bash
python step1_data.py
```

### 模型训练与评估
```bash
jupyter notebook step2_dataClean.ipynb
```

## 应用场景

- 食用菌鉴别与识别
- 野外采集辅助工具
- 毒蘑菇与食用菌区分
- 食品安全检测与监控
- 菌类分类学研究辅助工具
- 蘑菇知识科普与教育

## 未来改进

- 扩充数据集，增加更多种类的蘑菇
- 改进模型架构，提高识别准确率，特别是相似种类的区分
- 开发移动应用，实现现场识别功能
- 添加毒蘑菇警告标识，提高安全性
- 建立更完善的蘑菇知识库，包括营养成分和食用方法

## 参考资料

- 《中国大型真菌》
- 《食用菌栽培学》
- TensorFlow官方文档
- 《深度学习》(Ian Goodfellow, Yoshua Bengio and Aaron Courville)

## 许可证

MIT License